<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width minimum-scale=1.0 maximum-scale=1.0 user-scalable=no" />
    <title>Elite Schedule App</title>
    <link href="lib/css/mmenu.css" rel="stylesheet" />

    <link rel="stylesheet" href="lib/css/onsenui.css">
    <link rel="stylesheet" href="lib/css/onsen-css-components.min.css">
    <script src="lib/js/onsenui.min.js"></script>

    <link href="lib/css/demo.css" rel="stylesheet" />
</head>
<body>
  <div id="my-page" class="sc-container">
    <div id="my-header" class="header">
      <a href="#my-menu"><span></span></a>
      Elite Schedule
      <nav id="my-menu">
        <ul>
          <li><a onclick="navigate('#!/')" href="#!/">Home</a></li>
          <li><a onclick="navigate('#!/teams')" href="#!/teams">Teams</a>
          <li><a onclick="navigate('#!/standings')" href="#!/standings">Standings</a></li>
        </ul>
      </nav>
    </div>
    <div id="my-content" class="sc-container">
      
      <router-view></router-view>
    </div>
  </div>
  <script src="lib/js/tulipan.min.js"></script>
  <script src="lib/js/jquery-3.1.1.min.js"></script>
  <script src="lib/js/mmenu.js"></script>
  <script src="lib/js/mmenu.polyfills.js"></script>
  
  <script>
    var menu = new Mmenu( "#my-menu", {
      // options
      }, {
      // configuration
        classNames: {
          selected: "active"
        }
    });
    function navigate(url){
      menu.close();
      window.location.assign(url);
    }
  </script>

  <script>

    var vm1 = new Tulipan({

      template: {
          url: "views/home.html",
          async: false
      },
      
      route: "/",

      data: {
          name: "home",
          leagues: [],
          progress: true,
      },

      methods: {

        after: function(params, query){
          this.progress = true;
          console.log("home routed");
          this.$http.get('http://elite-schedule.net/api/leaguedata')
          .then(function (res){
            this.$store.set('leagues', res.data);
            this.$set("leagues", res.data);
            this.$set("progress", false);
          }, function(err){
            console.log(err);
          }) 
        },
        
        selectLeague: function(leagueId){
          this.$router.navigate("#!/leagues/" + leagueId);

        }
      }
    });

    var vm2 = new Tulipan({

      template: {
          url: "views/teams.html",
          async: false
      },
      
      route: "/leagues/:id",

      data: {
          progress: true,
          name: "teams",
          teams: [],
      },

      methods: {

        after: function(params, query){
          this.resetTeams();
          var leagueId = params.id;
          this.progress = true,
          this.$http.get('http://elite-schedule.net/api/leaguedata/' + leagueId)
          .then(function (res){
            this.$set("teams", res.data.teams);
            this.progress = false;
          }, function(err){
            console.log(err);
          }) 
        },

        resetTeams: function(){
          this.$set("teams", {});
        },

        selectTeam: function(teamId){
          console.log(teamId);
          this.$router.navigate("#!/leagues/team/" + teamId);
        }
      }
    });

    var vm3 = new Tulipan({

      template: {
          url: "views/standings.html",
          async: false
      },
      
      route: "/standings",

      data: {
          name: "standings"
      },

      methods: {

        after: function(params, query){
          console.log("standings routed");
          console.log(query);
        },
      }
    });

</script>
</body>
</html>